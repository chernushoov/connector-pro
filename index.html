<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#6B5CE7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Connector">
    <meta name="description" content="Connector Pro - Работа найдётся для каждого">

    <title>Connector Pro</title>

    <link rel="manifest" href="./manifest.json">
    <link rel="apple-touch-icon" href="./icons/icon-192.svg">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div id="app">
        <!-- Auth Screen -->
        <div id="screen-auth" class="screen active">
            <div class="auth-container">
                <div class="auth-header">
                    <div class="logo">
                        <div class="logo-animated">
                            <svg class="logo-svg" width="80" height="80" viewBox="0 0 192 192">
                                <rect width="192" height="192" rx="40" fill="white"/>
                                <g transform="translate(96, 96)">
                                    <circle class="ring ring-left" cx="-22" cy="0" r="30" fill="none" stroke="#6B5CE7" stroke-width="10"/>
                                    <circle class="ring ring-right" cx="22" cy="0" r="30" fill="none" stroke="#6B5CE7" stroke-width="10"/>
                                </g>
                                <circle class="dot dot-left" cx="50" cy="96" r="6" fill="#F5BD42"/>
                                <circle class="dot dot-right" cx="142" cy="96" r="6" fill="#F5BD42"/>
                            </svg>
                        </div>
                    </div>
                    <h1 data-l10n="app.name">Connector</h1>
                    <p class="tagline" data-l10n="app.tagline">Работа найдётся для каждого</p>
                </div>

                <div class="auth-box">
                    <h2 data-l10n="auth.title">Подтвердите, что вы настоящий</h2>
                    <p data-l10n="auth.sub">Иначе это станет фермой фейков</p>

                    <div id="auth-step-phone" class="auth-step active">
                        <input type="tel" id="phone-input" placeholder="+972" data-l10n-placeholder="auth.phone.placeholder">
                        <button class="btn btn-primary" onclick="App.sendSMS()" data-l10n="auth.send">Отправить код</button>
                    </div>

                    <div id="auth-step-code" class="auth-step">
                        <input type="text" id="code-input" maxlength="6" placeholder="000000" data-l10n-placeholder="auth.code.placeholder">
                        <div id="debug-code" class="debug-code"></div>
                        <button class="btn btn-primary" onclick="App.verifySMS()" data-l10n="auth.verify">Подтвердить</button>
                        <button class="btn btn-text" onclick="App.backToPhone()" data-l10n="auth.back">Назад</button>
                    </div>

                    <div id="auth-error" class="error-msg"></div>
                </div>

                <div class="powered" data-l10n="powered">Powered by FloorDSGN</div>
            </div>

            <div class="lang-selector">
                <button onclick="App.setLang('ru')" class="lang-btn" data-lang="ru">RU</button>
                <button onclick="App.setLang('he')" class="lang-btn" data-lang="he">HE</button>
                <button onclick="App.setLang('en')" class="lang-btn" data-lang="en">EN</button>
                <button onclick="App.setLang('ar')" class="lang-btn" data-lang="ar">AR</button>
            </div>
        </div>

        <!-- Role Selection Screen -->
        <div id="screen-role" class="screen">
            <div class="role-container">
                <h1 data-l10n="role.title">Кто вы?</h1>

                <div class="role-cards">
                    <div class="role-card" onclick="App.selectRole('worker')">
                        <div class="role-icon">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                                <path d="M6 3l1.5 1.5M18 3l-1.5 1.5M12 1v2"/>
                            </svg>
                        </div>
                        <h3 data-l10n="role.worker">Ищу работу</h3>
                    </div>

                    <div class="role-card" onclick="App.selectRole('employer')">
                        <div class="role-icon">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <path d="M9 3v18M3 9h18M3 15h6"/>
                            </svg>
                        </div>
                        <h3 data-l10n="role.employer">Ищу работника</h3>
                    </div>
                </div>

                <button class="btn btn-text logout-btn" onclick="App.logout()" data-l10n="logout">Выйти</button>
            </div>

            <div class="lang-selector">
                <button onclick="App.setLang('ru')" class="lang-btn" data-lang="ru">RU</button>
                <button onclick="App.setLang('he')" class="lang-btn" data-lang="he">HE</button>
                <button onclick="App.setLang('en')" class="lang-btn" data-lang="en">EN</button>
                <button onclick="App.setLang('ar')" class="lang-btn" data-lang="ar">AR</button>
            </div>
        </div>

        <!-- Worker Profile Form -->
        <div id="screen-worker-form" class="screen">
            <div class="form-container">
                <h1 data-l10n="profile.mandatory.title">Заполните анкету</h1>
                <p data-l10n="profile.mandatory.sub">1-2 минуты. Так вас будут звать на смены.</p>

                <form id="worker-form" onsubmit="App.saveWorkerProfile(event)">
                    <input type="text" id="worker-name" required data-l10n-placeholder="profile.worker.name" placeholder="Имя и фамилия">
                    <input type="tel" id="worker-phone" required data-l10n-placeholder="profile.worker.phone" placeholder="Телефон">

                    <div class="form-row">
                        <input type="text" id="worker-age" data-l10n-placeholder="profile.worker.age" placeholder="Возраст">
                        <input type="text" id="worker-city" required data-l10n-placeholder="profile.worker.city" placeholder="Город">
                    </div>

                    <input type="text" id="worker-spec" required data-l10n-placeholder="profile.worker.spec" placeholder="Специализация">

                    <div class="form-row">
                        <input type="text" id="worker-exp" data-l10n-placeholder="profile.worker.exp" placeholder="Опыт (лет)">
                        <input type="text" id="worker-rate" data-l10n-placeholder="profile.worker.rate" placeholder="Ставка /ч">
                    </div>

                    <label class="checkbox-label">
                        <input type="checkbox" id="worker-car">
                        <span data-l10n="profile.worker.car">Есть автомобиль</span>
                    </label>

                    <textarea id="worker-about" rows="3" data-l10n-placeholder="profile.worker.about" placeholder="О себе"></textarea>

                    <button type="submit" class="btn btn-primary" data-l10n="profile.worker.submit">Создать профиль</button>
                </form>
            </div>
        </div>

        <!-- Worker Main App -->
        <div id="screen-worker-app" class="screen">
            <div class="app-header">
                <button class="back-btn" onclick="App.goToRole()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>
                <h1 data-l10n="tabs.shifts">Смены</h1>
                <div class="header-actions">
                    <button onclick="App.showGuide()" class="icon-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="search-bar">
                <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
                <input type="text" id="search-input" data-l10n-placeholder="search.placeholder" placeholder="Поиск: работа / город / компания" oninput="App.filterShifts()">
            </div>

            <div class="filters">
                <button class="filter-btn active" data-filter="all" onclick="App.setFilter('all')" data-l10n="filters.all">Все</button>
                <button class="filter-btn" data-filter="today" onclick="App.setFilter('today')" data-l10n="filters.today">Сегодня</button>
                <button class="filter-btn" data-filter="tomorrow" onclick="App.setFilter('tomorrow')" data-l10n="filters.tomorrow">Завтра</button>
                <button class="filter-btn" data-filter="instant" onclick="App.setFilter('instant')" data-l10n="filters.instant">Instant</button>
            </div>

            <div id="shifts-list" class="shifts-list"></div>

            <nav class="tab-bar">
                <button class="tab active" data-tab="shifts" onclick="App.switchTab('shifts')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span data-l10n="tabs.shifts">Смены</span>
                </button>
                <button class="tab" data-tab="tasks" onclick="App.switchTab('tasks')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span data-l10n="taskflow.title">Задачи</span>
                </button>
                <button class="tab" data-tab="profile" onclick="App.switchTab('profile')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <span data-l10n="tabs.profile">Профиль</span>
                </button>
            </nav>
        </div>

        <!-- Shift Detail Modal -->
        <div id="modal-shift" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="shift-detail-title"></h2>
                    <button class="close-btn" onclick="App.closeModal('shift')">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div id="shift-detail-content" class="modal-body"></div>
            </div>
        </div>

        <!-- Tasks Tab Content -->
        <div id="screen-tasks" class="screen">
            <div class="app-header">
                <button class="back-btn" onclick="App.goToRole()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>
                <h1 data-l10n="taskflow.title">Мои задачи</h1>
            </div>

            <div id="tasks-list" class="tasks-list"></div>

            <nav class="tab-bar">
                <button class="tab" data-tab="shifts" onclick="App.switchTab('shifts')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span data-l10n="tabs.shifts">Смены</span>
                </button>
                <button class="tab active" data-tab="tasks" onclick="App.switchTab('tasks')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span data-l10n="taskflow.title">Задачи</span>
                </button>
                <button class="tab" data-tab="profile" onclick="App.switchTab('profile')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <span data-l10n="tabs.profile">Профиль</span>
                </button>
            </nav>
        </div>

        <!-- Profile Tab Content -->
        <div id="screen-profile" class="screen">
            <div class="app-header">
                <button class="back-btn" onclick="App.goToRole()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>
                <h1 data-l10n="tabs.profile">Профиль</h1>
                <div class="header-actions">
                    <button onclick="App.editProfile()" class="icon-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div id="profile-content" class="profile-content"></div>

            <nav class="tab-bar">
                <button class="tab" data-tab="shifts" onclick="App.switchTab('shifts')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                        <line x1="16" y1="2" x2="16" y2="6"/>
                        <line x1="8" y1="2" x2="8" y2="6"/>
                        <line x1="3" y1="10" x2="21" y2="10"/>
                    </svg>
                    <span data-l10n="tabs.shifts">Смены</span>
                </button>
                <button class="tab" data-tab="tasks" onclick="App.switchTab('tasks')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span data-l10n="taskflow.title">Задачи</span>
                </button>
                <button class="tab active" data-tab="profile" onclick="App.switchTab('profile')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                    <span data-l10n="tabs.profile">Профиль</span>
                </button>
            </nav>
        </div>

        <!-- Employer Profile Form -->
        <div id="screen-employer-form" class="screen">
            <div class="form-container">
                <h1 data-l10n="employer.mandatory.title">Анкета работодателя</h1>
                <p data-l10n="employer.mandatory.sub">Честно и прозрачно.</p>

                <form id="employer-form" onsubmit="App.saveEmployerProfile(event)">
                    <input type="text" id="employer-company" required data-l10n-placeholder="employer.company" placeholder="Компания">
                    <input type="text" id="employer-name" required data-l10n-placeholder="employer.contact" placeholder="Контактное лицо">
                    <input type="tel" id="employer-phone" required data-l10n-placeholder="employer.phone" placeholder="Телефон">
                    <input type="text" id="employer-city" required data-l10n-placeholder="employer.city" placeholder="Город">
                    <input type="text" id="employer-industry" data-l10n-placeholder="employer.industry" placeholder="Сфера">

                    <button type="submit" class="btn btn-primary" data-l10n="employer.submit">Создать кабинет</button>
                </form>
            </div>
        </div>

        <!-- Employer Main App -->
        <div id="screen-employer-app" class="screen">
            <div class="app-header">
                <button class="back-btn" onclick="App.goToRole()">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>
                <h1 data-l10n="tabs.dashboard">Панель</h1>
                <div class="header-actions">
                    <button onclick="App.showGuide()" class="icon-btn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                            <line x1="12" y1="17" x2="12.01" y2="17"/>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="dashboard-content">
                <div class="card welcome-card">
                    <h3 data-l10n="dashboard.title">Панель</h3>
                    <p data-l10n="dashboard.subtitle">Публикуйте смены и выбирайте людей</p>
                </div>

                <button class="btn btn-primary btn-block btn-create" onclick="App.showCreateShift()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    <span data-l10n="dashboard.create.shift">Создать смену</span>
                </button>

                <div id="employer-shifts" class="shifts-list"></div>

                <div id="applications-section" class="card">
                    <h3 data-l10n="dashboard.applications">Входящие отклики</h3>
                    <div id="applications-list"></div>
                </div>
            </div>

            <nav class="tab-bar">
                <button class="tab active" data-tab="dashboard" onclick="App.switchEmployerTab('dashboard')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                    <span data-l10n="tabs.dashboard">Панель</span>
                </button>
                <button class="tab" data-tab="emp-tasks" onclick="App.switchEmployerTab('emp-tasks')">
                    <svg class="tab-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                        <polyline points="22 4 12 14.01 9 11.01"/>
                    </svg>
                    <span data-l10n="taskflow.title">Задачи</span>
                </button>
            </nav>
        </div>

        <!-- Create Shift Modal -->
        <div id="modal-create-shift" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 data-l10n="create.shift.title">Создать смену</h2>
                    <button class="close-btn" onclick="App.closeModal('create-shift')">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="create-shift-form" onsubmit="App.createShift(event)">
                        <input type="text" id="shift-title" required data-l10n-placeholder="create.shift.job.placeholder" placeholder="Название работы">

                        <div class="form-row">
                            <input type="date" id="shift-date" required>
                            <input type="time" id="shift-start" required value="09:00">
                            <input type="time" id="shift-end" required value="17:00">
                        </div>

                        <div class="form-row">
                            <input type="number" id="shift-rate" required placeholder="/час" value="50">
                            <input type="number" id="shift-slots" required placeholder="Мест" value="1">
                        </div>

                        <input type="text" id="shift-city" required data-l10n-placeholder="create.shift.city.placeholder" placeholder="Город">

                        <textarea id="shift-requirements" rows="2" data-l10n-placeholder="create.shift.requirements.placeholder" placeholder="Требования"></textarea>

                        <label class="checkbox-label">
                            <input type="checkbox" id="shift-instant">
                            <span data-l10n="create.shift.instant">Срочная смена (Instant)</span>
                        </label>

                        <button type="submit" class="btn btn-primary" data-l10n="create.shift.publish">Опубликовать</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Guide Modal -->
        <div id="modal-guide" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 data-l10n="guide.title">Мини-обучение</h2>
                    <button class="close-btn" onclick="App.closeModal('guide')">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body guide-content">
                    <p data-l10n="guide.sub">Сделано так, чтобы вы быстрее начали зарабатывать.</p>

                    <h4 data-l10n="guide.section.core">Ключевая идея</h4>
                    <p data-l10n="guide.core">Профиль - отклик - контакт - смена. Без бюрократии.</p>

                    <h4 data-l10n="guide.section.worker">Для работников</h4>
                    <ul>
                        <li data-l10n="guide.worker.1">Заполните профиль</li>
                        <li data-l10n="guide.worker.2">Включите Instant для срочных смен</li>
                        <li data-l10n="guide.worker.3">Пишите в WhatsApp по кнопке</li>
                    </ul>

                    <button class="btn btn-primary" onclick="App.closeModal('guide')" data-l10n="guide.done">Понял</button>
                </div>
            </div>
        </div>
    </div>

    <script src="./js/l10n.js"></script>
    <script src="./js/app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(registrations => {
                registrations.forEach(reg => reg.unregister());
            });
            caches.keys().then(keys => {
                keys.forEach(key => caches.delete(key));
            });
            setTimeout(() => {
                navigator.serviceWorker.register('./sw.js');
            }, 1000);
        }
    </script>
</body>
</html>
